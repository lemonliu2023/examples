var f=Object.defineProperty;var L=(s,e,n)=>e in s?f(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var t=(s,e,n)=>L(s,typeof e!="symbol"?e+"":e,n);import{r as c,Y as a}from"./index-D3khomyw.js";import{G as P,u as g}from"./useInitAll-CbSIb_cJ.js";import{b as M}from"./points-C26p6jvW.js";import{i as h,c as x,G}from"./index-BHls4mjE.js";import{t as m}from"./index-DdmoGPpG.js";class j{constructor(e,n){t(this,"name");t(this,"scene");t(this,"options");t(this,"mesh");t(this,"material");t(this,"geometry");t(this,"animationId");t(this,"points",[]);t(this,"cur",0);t(this,"brokenCur",0);t(this,"glowPlaneLineMeshInsList",[]);this.name="BrokenGlowPlaneLineMesh",this.scene=e;const i={points:[],glowPlaneLineOptions:h};this.options=Object.assign(i,{...n,glowPlaneLineOptions:{...h,...n==null?void 0:n.glowPlaneLineOptions}})}createMesh(){const{glowPlaneLineOptions:{glowColor:e,glowRate:n,centerColor:i}}=this.options;this.material=x(e,i,n),this.mesh=new P;const{points:o}=this.options;return o.forEach(([r,p])=>{var l;const u=m(r),w=m(p),d=new G(this.scene,{start:u,end:w,material:this.material}).createMesh();(l=this.mesh)==null||l.add(d)}),this.mesh}addToScene(){this.createMesh(),this.startAnimation(performance.now()),this.scene.add(this.mesh)}startAnimation(e){if(!e||!this.material){console.error(`${this.name}动画开始依赖的动画开始时间或材质缺失，请检查`);return}const{speed:n}=this.options.glowPlaneLineOptions,o=(performance.now()-e)*.001;this.material.uniforms.u_amplitude.value=Math.sin(2*o*Math.PI*n),this.animationId=requestAnimationFrame(()=>this.startAnimation(e))}stopAnimation(){}}const A=()=>{const s=c.useRef(),e=M.map(o=>[o.x,o.y,o.z]),n=[];e.reduce((o,r)=>(n.push([o,r]),r));const{sceneRef:i}=g("threejs-examples");return c.useEffect(()=>{s.current=new j(i.current,{points:n}),s.current.addToScene()},[i,s,e]),a.jsx(a.Fragment,{children:a.jsx("div",{className:"threejs-examples-main",children:a.jsx("div",{id:"threejs-examples"})})})};export{A as default};

var u=Object.defineProperty;var p=(n,e,s)=>e in n?u(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var t=(n,e,s)=>p(n,typeof e!="symbol"?e+"":e,s);import{r as a,Y as h}from"./index-D3khomyw.js";import{L as w,V as l,G as L,u as d}from"./useInitAll-CbSIb_cJ.js";import{b as P}from"./points-C26p6jvW.js";import{G as g,i as k}from"./index-BHls4mjE.js";import{t as c}from"./index-DdmoGPpG.js";class b{constructor(e,s){t(this,"name");t(this,"scene");t(this,"options");t(this,"mesh");t(this,"material");t(this,"geometry");t(this,"animationId");t(this,"points",[]);t(this,"cur",0);t(this,"brokenCur",0);t(this,"glowPlaneLineMeshInsList",[]);this.name="GlowBrokenGlowPlaneLineMesh",this.scene=e;const i={points:[],glowSpeed:1,glowPlaneLineOptions:k};this.options=Object.assign(i,s)}createPoints(){const{points:e}=this.options,s=e[this.brokenCur],i=e[this.brokenCur+1],o=c(s),r=c(i);console.log(o,r);const m=new w(new l(o.x,o.y,o.z),new l(r.x,r.y,r.z));this.points=m.getPoints(o.distanceTo(r))}createGlowPlaneLineMesh(){return new g(this.scene,{start:this.points[0],end:this.points[this.cur]}).createMeshAndStartAnimation()}addToScene(){var e;this.createPoints(),this.glowPlaneLineMeshInsList[this.brokenCur]=this.createGlowPlaneLineMesh(),this.mesh=new L,(e=this.mesh)==null||e.add(this.glowPlaneLineMeshInsList[this.brokenCur].mesh),this.startAnimation(performance.now()),this.scene.add(this.mesh)}startAnimation(e){var s,i,o,r;if((s=this.glowPlaneLineMeshInsList[this.brokenCur])==null||s.destroy(),(o=this.mesh)==null||o.remove((i=this.glowPlaneLineMeshInsList[this.brokenCur])==null?void 0:i.mesh),this.glowPlaneLineMeshInsList[this.brokenCur]=this.createGlowPlaneLineMesh(),(r=this.mesh)==null||r.add(this.glowPlaneLineMeshInsList[this.brokenCur].mesh),this.cur+=3,this.cur>=this.points.length-1){if(console.log(this.cur,this.points.length-1,this.brokenCur,"this.cur, this.points.length - 1"),this.brokenCur>=this.options.points.length-2)return;this.brokenCur+=1,this.cur=0,this.createPoints()}this.animationId=requestAnimationFrame(()=>this.startAnimation(e))}stopAnimation(){}}const j=()=>{const n=a.useRef(),e=P.map(i=>[i.x,i.y,i.z]),{sceneRef:s}=d("threejs-examples");return a.useEffect(()=>{n.current=new b(s.current,{points:e}),n.current.addToScene()},[s,n,e]),h.jsx(h.Fragment,{children:h.jsx("div",{className:"threejs-examples-main",children:h.jsx("div",{id:"threejs-examples"})})})};export{j as default};

import{g as B,c as D,j as g}from"./index-_74sN05i.js";import{t as j,T as q,R as O,e as H,c as G,u as I}from"./useInitAll-BZnQvJx1.js";import{b as z}from"./points-C26p6jvW.js";function N(h){throw new Error('Could not dynamically require "'+h+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var M={exports:{}};const $=B(j);(function(h,l){(function(){var v=this,d=typeof N<"u",i=v.THREE||d&&$;if(!i)throw new Error("MeshLine requires three.js");class n extends i.BufferGeometry{constructor(){super(),this.isMeshLine=!0,this.type="MeshLine",this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],this.counters=[],this._points=[],this._geom=null,this.widthCallback=null,this.matrixWorld=new i.Matrix4,Object.defineProperties(this,{geometry:{enumerable:!0,get:function(){return this}},geom:{enumerable:!0,get:function(){return this._geom},set:function(r){this.setGeometry(r,this.widthCallback)}},points:{enumerable:!0,get:function(){return this._points},set:function(r){this.setPoints(r,this.widthCallback)}}})}}n.prototype.setMatrixWorld=function(e){this.matrixWorld=e},n.prototype.setGeometry=function(e,r){this._geometry=e,this.setPoints(e.getAttribute("position").array,r)},n.prototype.setPoints=function(e,r){if(!(e instanceof Float32Array)&&!(e instanceof Array)){console.error("ERROR: The BufferArray of points is not instancied correctly.");return}if(this._points=e,this.widthCallback=r,this.positions=[],this.counters=[],e.length&&e[0]instanceof i.Vector3)for(var t=0;t<e.length;t++){var a=e[t],s=t/e.length;this.positions.push(a.x,a.y,a.z),this.positions.push(a.x,a.y,a.z),this.counters.push(s),this.counters.push(s)}else for(var t=0;t<e.length;t+=3){var s=t/e.length;this.positions.push(e[t],e[t+1],e[t+2]),this.positions.push(e[t],e[t+1],e[t+2]),this.counters.push(s),this.counters.push(s)}this.process()};function m(e,r){var t=new i.Matrix4,a=new i.Ray,s=new i.Sphere,o=new i.Vector3,f=this.geometry;if(f.boundingSphere||f.computeBoundingSphere(),s.copy(f.boundingSphere),s.applyMatrix4(this.matrixWorld),e.ray.intersectSphere(s,o)!==!1){t.copy(this.matrixWorld).invert(),a.copy(e.ray).applyMatrix4(t);var u=new i.Vector3,b=new i.Vector3,x=new i.Vector3,w=this instanceof i.LineSegments?2:1,P=f.index,C=f.attributes;if(P!==null)for(var A=P.array,R=C.position.array,S=C.width.array,c=0,L=A.length-1;c<L;c+=w){var W=A[c],U=A[c+1];u.fromArray(R,W*3),b.fromArray(R,U*3);var T=S[Math.floor(c/3)]!==void 0?S[Math.floor(c/3)]:1,V=e.params.Line.threshold+this.material.lineWidth*T/2,F=V*V,E=a.distanceSqToSegment(u,b,o,x);if(!(E>F)){o.applyMatrix4(this.matrixWorld);var _=e.ray.origin.distanceTo(o);_<e.near||_>e.far||(r.push({distance:_,point:x.clone().applyMatrix4(this.matrixWorld),index:c,face:null,faceIndex:null,object:this}),c=L)}}}}n.prototype.raycast=m,n.prototype.compareV3=function(e,r){var t=e*6,a=r*6;return this.positions[t]===this.positions[a]&&this.positions[t+1]===this.positions[a+1]&&this.positions[t+2]===this.positions[a+2]},n.prototype.copyV3=function(e){var r=e*6;return[this.positions[r],this.positions[r+1],this.positions[r+2]]},n.prototype.process=function(){var e=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];var r,t;this.compareV3(0,e-1)?t=this.copyV3(e-2):t=this.copyV3(0),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);for(var a=0;a<e;a++){if(this.side.push(1),this.side.push(-1),this.widthCallback?r=this.widthCallback(a/(e-1)):r=1,this.width.push(r),this.width.push(r),this.uvs.push(a/(e-1),0),this.uvs.push(a/(e-1),1),a<e-1){t=this.copyV3(a),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);var s=a*2;this.indices_array.push(s,s+1,s+2),this.indices_array.push(s+2,s+1,s+3)}a>0&&(t=this.copyV3(a),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]))}this.compareV3(e-1,0)?t=this.copyV3(1):t=this.copyV3(e-1),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]),!this._attributes||this._attributes.position.count!==this.positions.length?this._attributes={position:new i.BufferAttribute(new Float32Array(this.positions),3),previous:new i.BufferAttribute(new Float32Array(this.previous),3),next:new i.BufferAttribute(new Float32Array(this.next),3),side:new i.BufferAttribute(new Float32Array(this.side),1),width:new i.BufferAttribute(new Float32Array(this.width),1),uv:new i.BufferAttribute(new Float32Array(this.uvs),2),index:new i.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new i.BufferAttribute(new Float32Array(this.counters),1)}:(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()};function y(e,r,t,a,s){var o;if(e=e.subarray||e.slice?e:e.buffer,t=t.subarray||t.slice?t:t.buffer,e=r?e.subarray?e.subarray(r,s&&r+s):e.slice(r,s&&r+s):e,t.set)t.set(e,a);else for(o=0;o<e.length;o++)t[o+a]=e[o];return t}n.prototype.advance=function(e){var r=this._attributes.position.array,t=this._attributes.previous.array,a=this._attributes.next.array,s=r.length;y(r,0,t,0,s),y(r,6,r,0,s-6),r[s-6]=e.x,r[s-5]=e.y,r[s-4]=e.z,r[s-3]=e.x,r[s-2]=e.y,r[s-1]=e.z,y(r,6,a,0,s-6),a[s-6]=e.x,a[s-5]=e.y,a[s-4]=e.z,a[s-3]=e.x,a[s-2]=e.y,a[s-1]=e.z,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0},i.ShaderChunk.meshline_vert=["",i.ShaderChunk.logdepthbuf_pars_vertex,i.ShaderChunk.fog_pars_vertex,"","attribute vec3 previous;","attribute vec3 next;","attribute float side;","attribute float width;","attribute float counters;","","uniform vec2 resolution;","uniform float lineWidth;","uniform vec3 color;","uniform float opacity;","uniform float sizeAttenuation;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","vec2 fix( vec4 i, float aspect ) {","","    vec2 res = i.xy / i.w;","    res.x *= aspect;","	 vCounters = counters;","    return res;","","}","","void main() {","","    float aspect = resolution.x / resolution.y;","","    vColor = vec4( color, opacity );","    vUV = uv;","","    mat4 m = projectionMatrix * modelViewMatrix;","    vec4 finalPosition = m * vec4( position, 1.0 );","    vec4 prevPos = m * vec4( previous, 1.0 );","    vec4 nextPos = m * vec4( next, 1.0 );","","    vec2 currentP = fix( finalPosition, aspect );","    vec2 prevP = fix( prevPos, aspect );","    vec2 nextP = fix( nextPos, aspect );","","    float w = lineWidth * width;","","    vec2 dir;","    if( nextP == currentP ) dir = normalize( currentP - prevP );","    else if( prevP == currentP ) dir = normalize( nextP - currentP );","    else {","        vec2 dir1 = normalize( currentP - prevP );","        vec2 dir2 = normalize( nextP - currentP );","        dir = normalize( dir1 + dir2 );","","        vec2 perp = vec2( -dir1.y, dir1.x );","        vec2 miter = vec2( -dir.y, dir.x );","        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );","","    }","","    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;","    vec4 normal = vec4( -dir.y, dir.x, 0., 1. );","    normal.xy *= .5 * w;","    normal *= projectionMatrix;","    if( sizeAttenuation == 0. ) {","        normal.xy *= finalPosition.w;","        normal.xy /= ( vec4( resolution, 0., 1. ) * projectionMatrix ).xy;","    }","","    finalPosition.xy += normal.xy * side;","","    gl_Position = finalPosition;","",i.ShaderChunk.logdepthbuf_vertex,i.ShaderChunk.fog_vertex&&"    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",i.ShaderChunk.fog_vertex,"}"].join(`
`),i.ShaderChunk.meshline_frag=["",i.ShaderChunk.fog_pars_fragment,i.ShaderChunk.logdepthbuf_pars_fragment,"","uniform sampler2D map;","uniform sampler2D alphaMap;","uniform float useMap;","uniform float useAlphaMap;","uniform float useDash;","uniform float dashArray;","uniform float dashOffset;","uniform float dashRatio;","uniform float visibility;","uniform float alphaTest;","uniform vec2 repeat;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","void main() {","",i.ShaderChunk.logdepthbuf_fragment,"","    vec4 c = vColor;","    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );","    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;","    if( c.a < alphaTest ) discard;","    if( useDash == 1. ){","        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));","    }","    gl_FragColor = c;","    gl_FragColor.a *= step(vCounters, visibility);","",i.ShaderChunk.fog_fragment,"}"].join(`
`);class p extends i.ShaderMaterial{constructor(r){super({uniforms:Object.assign({},i.UniformsLib.fog,{lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new i.Color(16777215)},opacity:{value:1},resolution:{value:new i.Vector2(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new i.Vector2(1,1)}}),vertexShader:i.ShaderChunk.meshline_vert,fragmentShader:i.ShaderChunk.meshline_frag}),this.isMeshLineMaterial=!0,this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(t){this.uniforms.lineWidth.value=t}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(t){this.uniforms.map.value=t}},useMap:{enumerable:!0,get:function(){return this.uniforms.useMap.value},set:function(t){this.uniforms.useMap.value=t}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(t){this.uniforms.alphaMap.value=t}},useAlphaMap:{enumerable:!0,get:function(){return this.uniforms.useAlphaMap.value},set:function(t){this.uniforms.useAlphaMap.value=t}},color:{enumerable:!0,get:function(){return this.uniforms.color.value},set:function(t){this.uniforms.color.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(t){this.uniforms.sizeAttenuation.value=t}},dashArray:{enumerable:!0,get:function(){return this.uniforms.dashArray.value},set:function(t){this.uniforms.dashArray.value=t,this.useDash=t!==0?1:0}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},dashRatio:{enumerable:!0,get:function(){return this.uniforms.dashRatio.value},set:function(t){this.uniforms.dashRatio.value=t}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(t){this.uniforms.useDash.value=t}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(t){this.uniforms.visibility.value=t}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(t){this.uniforms.alphaTest.value=t}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(t){this.uniforms.repeat.value.copy(t)}}}),this.setValues(r)}}p.prototype.copy=function(e){return i.ShaderMaterial.prototype.copy.call(this,e),this.lineWidth=e.lineWidth,this.map=e.map,this.useMap=e.useMap,this.alphaMap=e.alphaMap,this.useAlphaMap=e.useAlphaMap,this.color.copy(e.color),this.opacity=e.opacity,this.resolution.copy(e.resolution),this.sizeAttenuation=e.sizeAttenuation,this.dashArray.copy(e.dashArray),this.dashOffset.copy(e.dashOffset),this.dashRatio.copy(e.dashRatio),this.useDash=e.useDash,this.visibility=e.visibility,this.alphaTest=e.alphaTest,this.repeat.copy(e.repeat),this},h.exports&&(l=h.exports={MeshLine:n,MeshLineMaterial:p,MeshLineRaycast:m}),l.MeshLine=n,l.MeshLineMaterial=p,l.MeshLineRaycast=m}).call(D)})(M,M.exports);var k=M.exports;function J(h={}){const{textureUrl:l,color:v,lineWidth:d,startPosition:i,endPosition:n,speed:m,opacity:y}=Object.assign({textureUrl:"/next/public/tube_bg.png",lineWidth:4,speed:10,opacity:1,startPosition:z[0],endPosition:z[1]},h),p=new q().load(l);p.wrapS=p.wrapT=O,p.repeat.set(1,1);const e=new k.MeshLineMaterial({useMap:1,color:v,lineWidth:d,resolution:new H(window.innerWidth,window.innerHeight),sizeAttenuation:1,transparent:!0,map:p,opacity:y}),r=new k.MeshLine;r.setPoints([i.x,i.y,i.z]);const t=new G(r,e),a=[],s=.001;for(let u=0;u<1;u+=s){const b=i.x+(n.x-i.x)*u,x=i.y+(n.y-i.y)*u,w=i.z+(n.z-i.z)*u;a.push(b,x,w)}let o=3;function f(){requestAnimationFrame(f);const u=a.slice(0,o+=3*m);r.setPoints(u)}return f(),t}const Y=()=>{const{sceneRef:h,rendererRef:l}=I("threejs-examples");return React.useEffect(()=>{var v;return(v=h.current)==null||v.add(J()),()=>{var d;(d=l.current)==null||d.dispose()}},[l,h]),g.jsx(g.Fragment,{children:g.jsx("div",{className:"threejs-examples-main",children:g.jsx("div",{id:"threejs-examples"})})})};export{Y as default};
